!function(){"use strict";class e{constructor(e,t){let{data:s,handleCardClick:i,handleDeleteClick:r,handleLikeClick:n,userId:o}=e;this._name=s.name,this._link=s.link,this._id=s._id,this._likes=s.likes||[],this._ownerId=s.owner?s.owner._id:s.ownerId,this._userId=o,this._cardSelector=t,this._handleCardClick=i,this._handleDeleteClick=r,this._handleLikeClick=n,this._isLiked=void 0!==s.isLiked?s.isLiked:this._likes.some((e=>e._id===this._userId))}getId(){return this._id}isLiked(){return this._isLiked}updateLikes(e){this._likes=e.likes||[],this._isLiked=void 0!==e.isLiked?e.isLiked:this._likes.some((e=>e._id===this._userId)),this._renderLikes(),this._updateLikeButton()}_renderLikes(){this._likeCounter&&(this._likeCounter.textContent=this._likes.length)}_updateLikeButton(){this._likeButton&&(this._isLiked?this._likeButton.classList.add("card__like-button_active"):this._likeButton.classList.remove("card__like-button_active"))}_setEventListeners(){this._likeButton.addEventListener("click",(()=>{this._handleLikeClick(this)})),this._deleteButton.addEventListener("click",(()=>{this._handleDeleteClick(this)})),this._cardImage.addEventListener("click",(()=>{this._handleCardClick(this._name,this._link)}))}removeCard(){this._element.remove(),this._element=null}generateCard(){return this._element=this._getTemplate(),this._cardImage=this._element.querySelector(".card__image"),this._likeButton=this._element.querySelector(".card__like-button"),this._deleteButton=this._element.querySelector(".card__delete-button"),this._likeCounter=this._element.querySelector(".card__like-count"),this._setEventListeners(),this._renderLikes(),this._updateLikeButton(),this._cardImage.src=this._link,this._cardImage.alt=this._name,this._element.querySelector(".card__title").textContent=this._name,this._element}_getTemplate(){return document.querySelector(this._cardSelector).content.querySelector(".card").cloneNode(!0)}}class t{constructor(e,t){this._inputSelector=e.inputSelector,this._submitButtonSelector=e.submitButtonSelector,this._inactiveButtonClass=e.inactiveButtonClass,this._inputErrorClass=e.inputErrorClass,this._errorClass=e.errorClass,this._formElement=t,this._inputList=Array.from(this._formElement.querySelectorAll(this._inputSelector)),this._buttonElement=this._formElement.querySelector(this._submitButtonSelector)}_showInputError(e,t){const s=this._formElement.querySelector(`#${e.id}-error`);e.classList.add(this._inputErrorClass),s.textContent=t,s.classList.add(this._errorClass)}_hideInputError(e){const t=this._formElement.querySelector(`#${e.id}-error`);e.classList.remove(this._inputErrorClass),t.classList.remove(this._errorClass),t.textContent=""}_checkInputValidity(e){e.validity.valid?this._hideInputError(e):this._showInputError(e,e.validationMessage)}_hasInvalidInput(){return this._inputList.some((e=>!e.validity.valid))}_toggleButtonState(){this._hasInvalidInput()?(this._buttonElement.classList.add(this._inactiveButtonClass),this._buttonElement.disabled=!0):(this._buttonElement.classList.remove(this._inactiveButtonClass),this._buttonElement.disabled=!1)}_setEventListeners(){this._toggleButtonState(),this._inputList.forEach((e=>{e.addEventListener("input",(()=>{this._checkInputValidity(e),this._toggleButtonState()}))}))}enableValidation(){this._formElement.addEventListener("submit",(e=>{e.preventDefault()})),this._setEventListeners()}resetValidation(){this._toggleButtonState(),this._inputList.forEach((e=>{this._hideInputError(e)}))}checkButtonState(){this._toggleButtonState()}}class s{constructor(e,t){let{items:s,renderer:i}=e;this._items=Array.isArray(s)?s:[],this._renderer=i,this._container=document.querySelector(t)}renderItems(){this._items.forEach((e=>{e&&"object"==typeof e?this._renderer(e):console.error("Invalid item in Section:",e)}))}addItem(e){e&&this._container.prepend(e)}}class i{constructor(e){this._popup=document.querySelector(e),this._handleEscClose=this._handleEscClose.bind(this)}open(){this._popup.classList.add("modal_opened"),document.addEventListener("keydown",this._handleEscClose)}close(){this._popup.classList.remove("modal_opened"),document.removeEventListener("keydown",this._handleEscClose)}_handleEscClose(e){"Escape"===e.key&&this.close()}setEventListeners(){this._popup.addEventListener("mousedown",(e=>{(e.target.classList.contains("modal_opened")||e.target.classList.contains("modal__close"))&&this.close()}))}}class r extends i{constructor(e,t){super(e),this._handleFormSubmit=t,this._form=this._popup.querySelector(".modal__form"),this._inputs=this._form.querySelectorAll(".modal__input"),this._submitButton=this._form.querySelector(".modal__button")}_getInputValues(){const e={};return this._inputs.forEach((t=>{e[t.name]=t.value})),e}setInputValues(e){this._inputs.forEach((t=>{e[t.name]&&(t.value=e[t.name])}))}setEventListeners(){super.setEventListeners(),this._form.addEventListener("submit",(e=>{e.preventDefault();const t=this._getInputValues();this._handleFormSubmit(t)}))}resetForm(){this._form.reset(),this._formValidator&&this._formValidator.resetValidation()}renderLoading(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Saving...";this._submitButton.textContent=e?t:this._submitButton.dataset.text||"Save"}}function n(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"Saving...";return t.renderLoading(!0,s),e().then((e=>(t.close(),t.resetForm&&t.resetForm(),e))).catch((e=>{console.error(e)})).finally((()=>{t.renderLoading(!1)}))}let o,a;const l={},d=new class extends i{constructor(e){super(e),this._form=this._popup.querySelector(".modal__form"),this._submitButton=this._form.querySelector(".modal__button")}setAction(e){this._handleSubmit=e}setEventListeners(){super.setEventListeners(),this._form.addEventListener("submit",(e=>{e.preventDefault(),"function"==typeof this._handleSubmit?this._handleSubmit():console.error("No submit action set for PopupWithConfirmation")}))}renderLoading(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Deleting...";this._submitButton.textContent=e?t:"Yes"}}("#delete-card-modal"),_=new r("#profile__edit_modal",(function(e){n((function(){return h.setUserInfo(e).then((e=>{u.setUserInfo(e),_.resetForm()}))}),_)})),h=new class{constructor(e){let{baseUrl:t,headers:s}=e;this._baseUrl=t,this._headers=s,console.log("API Base URL:",this._baseUrl)}_checkResponse(e){return e.ok?e.json():Promise.reject(`Error: ${e.status}`)}_request(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const s={headers:this._headers,...t},i=`${this._baseUrl}${e}`;return fetch(i,s).then(this._checkResponse)}getUserInfo(){return this._request("/users/me")}getInitialCards(){return this._request("/cards")}setUserInfo(e){let{name:t,about:s}=e;return console.log("Sending user info:",{name:t,about:s}),this._request("/users/me",{method:"PATCH",body:JSON.stringify({name:t,about:s})}).then((e=>(console.log("Received data:",e),e)))}addCard(e){let{name:t,link:s}=e;return this._request("/cards",{method:"POST",body:JSON.stringify({name:t,link:s})})}likeCard(e){return this._request(`/cards/${e}/likes`,{method:"PUT"}).then((e=>(console.log("Like card response:",e),e)))}deleteCard(e){return this._request(`/cards/${e}`,{method:"DELETE"})}unlikeCard(e){return this._request(`/cards/${e}/likes`,{method:"DELETE"}).then((e=>(console.log("Unlike card response:",e),{...e,isLiked:!1})))}updateAvatar(e){return this._request("/users/me/avatar",{method:"PATCH",body:JSON.stringify({avatar:e})})}}({baseUrl:"https://around-api.en.tripleten-services.com/v1",headers:{authorization:"5db111ac-010a-455f-8b65-a9484d0efcee","Content-Type":"application/json"}}),u=new class{constructor(e){let{nameSelector:t,jobSelector:s,avatarSelector:i}=e;this._nameElement=document.querySelector(t),this._jobElement=document.querySelector(s),this._avatarElement=document.querySelector(i),this._name="",this._about="",this._avatar=""}getUserInfo(){return{name:this._name,about:this._about,avatar:this._avatar}}setUserInfo(e){let{name:t,about:s,avatar:i}=e;t&&(this._name=t),s&&(this._about=s),i&&(this._avatar=i),this.updateDOM()}updateDOM(){this._nameElement.textContent=this._name,this._jobElement.textContent=this._about,this._avatar&&(this._avatarElement.src=this._avatar)}}({nameSelector:".profile__title",jobSelector:".profile__description",avatarSelector:".profile__image"}),c=new class extends i{constructor(e){super(e),this._image=this._popup.querySelector(".modal__image"),this._caption=this._popup.querySelector(".modal__caption")}open(e,t){this._image.src=t,this._image.alt=e,this._caption.textContent=e,super.open()}}("#image_modal"),m=new r("#profile__edit_modal",(e=>{n((function(){return h.setUserInfo(e).then((e=>{u.setUserInfo(e)}))}),m)})),p=new r("#card__edit_modal",(e=>{n((function(){return h.addCard({name:e.title,link:e.url}).then((e=>{const t=f(e);return o.addItem(t),e}))}),p,"Creating...")})),v=new r("#avatar-edit-modal",(e=>{n((function(){return h.updateAvatar(e.avatar).then((e=>(u.setUserInfo(e),e)))}),v,"Saving...")}));var k;function f(t){return new e({data:{...t,ownerId:t.owner?t.owner._id:t.ownerId},handleCardClick:(e,t)=>{c.open(e,t)},handleDeleteClick:e=>{!function(e){d.setAction((()=>{n((function(){return h.deleteCard(e.getId()).then((()=>{e.removeCard()}))}),d,"Deleting...")})),d.open()}(e)},handleLikeClick:e=>{(e.isLiked()?h.unlikeCard(e.getId()):h.likeCard(e.getId())).then((t=>{e.updateLikes(t)})).catch((e=>console.error("Error updating like:",e)))},userId:a},"#card__template").generateCard()}Promise.all([h.getUserInfo(),h.getInitialCards()]).then((e=>{let[t,i]=e;u.setUserInfo(t),a=t._id,o=new s({items:i,renderer:e=>{const t=f(e);o.addItem(t)}},".cards__list"),o.renderItems()})).catch((e=>console.error(e))),document.querySelector(".profile__edit-button").addEventListener("click",(()=>{const e=u.getUserInfo();_.setInputValues(e),l["profile-form"].resetValidation(),_.open()})),document.querySelector(".profile__add-button").addEventListener("click",(()=>{l["card-form"].resetValidation(),p.open()})),document.querySelector(".profile__image").addEventListener("click",(()=>{l["avatar-form"]&&l["avatar-form"].resetValidation(),v.open()})),document.querySelector(".profile__image-container").addEventListener("click",(()=>{l["avatar-edit-form"].resetValidation(),l["avatar-edit-form"].checkButtonState(),v.open()})),k={formSelector:".modal__form",inputSelector:".modal__input",submitButtonSelector:".modal__button",inactiveButtonClass:"modal__button_disabled",inputErrorClass:"modal__input_type_error",errorClass:"modal__error_visible"},Array.from(document.querySelectorAll(k.formSelector)).forEach((e=>{const s=new t(k,e),i=e.getAttribute("name");l[i]=s,s.enableValidation()})),c.setEventListeners(),m.setEventListeners(),p.setEventListeners(),v.setEventListeners(),d.setEventListeners()}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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LEtBQUtuQixTQUFTb0IsaUJBQWlCaEIsRUFBT3NLLGVBQ3BEdkksU0FBUzlCLElBQ2hCLE1BQU1zSyxFQUFZLElBQUl4SyxFQUFjQyxFQUFRQyxHQUN0Q3VLLEVBQVd2SyxFQUFZd0ssYUFBYSxRQUMxQ3pFLEVBQWV3RSxHQUFZRCxFQUMzQkEsRUFBVXZJLGtCQUFrQixJQU9oQ3VILEVBQVcxRixvQkFDWDZGLEVBQWlCN0Ysb0JBQ2pCOEYsRUFBYTlGLG9CQUNibUcsRUFBZ0JuRyxvQkFDaEJvQyxFQUFnQnBDLG1CIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vQXJvdW5kIHRoZSBVUy8uL3NyYy9jb21wb25lbnRzL0NhcmQuanMiLCJ3ZWJwYWNrOi8vQXJvdW5kIHRoZSBVUy8uL3NyYy9jb21wb25lbnRzL0Zvcm1WYWxpZGF0b3IuanMiLCJ3ZWJwYWNrOi8vQXJvdW5kIHRoZSBVUy8uL3NyYy9jb21wb25lbnRzL1NlY3Rpb24uanMiLCJ3ZWJwYWNrOi8vQXJvdW5kIHRoZSBVUy8uL3NyYy9jb21wb25lbnRzL1BvcHVwLmpzIiwid2VicGFjazovL0Fyb3VuZCB0aGUgVVMvLi9zcmMvY29tcG9uZW50cy9Qb3B1cFdpdGhGb3JtLmpzIiwid2VicGFjazovL0Fyb3VuZCB0aGUgVVMvLi9zcmMvcGFnZXMvaW5kZXguanMiLCJ3ZWJwYWNrOi8vQXJvdW5kIHRoZSBVUy8uL3NyYy9jb21wb25lbnRzL1BvcHVwV2l0aENvbmZpcm1hdGlvbi5qcyIsIndlYnBhY2s6Ly9Bcm91bmQgdGhlIFVTLy4vc3JjL2NvbXBvbmVudHMvQXBpLmpzIiwid2VicGFjazovL0Fyb3VuZCB0aGUgVVMvLi9zcmMvY29tcG9uZW50cy9Vc2VySW5mby5qcyIsIndlYnBhY2s6Ly9Bcm91bmQgdGhlIFVTLy4vc3JjL2NvbXBvbmVudHMvUG9wdXBXaXRoSW1hZ2UuanMiLCJ3ZWJwYWNrOi8vQXJvdW5kIHRoZSBVUy8uL3NyYy91dGlscy9jb25zdGFudHMuanMiXSwic291cmNlc0NvbnRlbnQiOlsiZXhwb3J0IGRlZmF1bHQgY2xhc3MgQ2FyZCB7XG4gIGNvbnN0cnVjdG9yKFxuICAgIHsgZGF0YSwgaGFuZGxlQ2FyZENsaWNrLCBoYW5kbGVEZWxldGVDbGljaywgaGFuZGxlTGlrZUNsaWNrLCB1c2VySWQgfSxcbiAgICBjYXJkU2VsZWN0b3JcbiAgKSB7XG4gICAgdGhpcy5fbmFtZSA9IGRhdGEubmFtZTtcbiAgICB0aGlzLl9saW5rID0gZGF0YS5saW5rO1xuICAgIHRoaXMuX2lkID0gZGF0YS5faWQ7XG4gICAgdGhpcy5fbGlrZXMgPSBkYXRhLmxpa2VzIHx8IFtdO1xuICAgIHRoaXMuX293bmVySWQgPSBkYXRhLm93bmVyID8gZGF0YS5vd25lci5faWQgOiBkYXRhLm93bmVySWQ7XG4gICAgdGhpcy5fdXNlcklkID0gdXNlcklkO1xuICAgIHRoaXMuX2NhcmRTZWxlY3RvciA9IGNhcmRTZWxlY3RvcjtcbiAgICB0aGlzLl9oYW5kbGVDYXJkQ2xpY2sgPSBoYW5kbGVDYXJkQ2xpY2s7XG4gICAgdGhpcy5faGFuZGxlRGVsZXRlQ2xpY2sgPSBoYW5kbGVEZWxldGVDbGljaztcbiAgICB0aGlzLl9oYW5kbGVMaWtlQ2xpY2sgPSBoYW5kbGVMaWtlQ2xpY2s7XG5cbiAgICB0aGlzLl9pc0xpa2VkID1cbiAgICAgIGRhdGEuaXNMaWtlZCAhPT0gdW5kZWZpbmVkXG4gICAgICAgID8gZGF0YS5pc0xpa2VkXG4gICAgICAgIDogdGhpcy5fbGlrZXMuc29tZSgodXNlcikgPT4gdXNlci5faWQgPT09IHRoaXMuX3VzZXJJZCk7XG4gIH1cblxuICBnZXRJZCgpIHtcbiAgICByZXR1cm4gdGhpcy5faWQ7XG4gIH1cblxuICBpc0xpa2VkKCkge1xuICAgIHJldHVybiB0aGlzLl9pc0xpa2VkO1xuICB9XG5cbiAgdXBkYXRlTGlrZXModXBkYXRlZENhcmQpIHtcbiAgICB0aGlzLl9saWtlcyA9IHVwZGF0ZWRDYXJkLmxpa2VzIHx8IFtdO1xuICAgIHRoaXMuX2lzTGlrZWQgPVxuICAgICAgdXBkYXRlZENhcmQuaXNMaWtlZCAhPT0gdW5kZWZpbmVkXG4gICAgICAgID8gdXBkYXRlZENhcmQuaXNMaWtlZFxuICAgICAgICA6IHRoaXMuX2xpa2VzLnNvbWUoKHVzZXIpID0+IHVzZXIuX2lkID09PSB0aGlzLl91c2VySWQpO1xuICAgIHRoaXMuX3JlbmRlckxpa2VzKCk7XG4gICAgdGhpcy5fdXBkYXRlTGlrZUJ1dHRvbigpO1xuICB9XG5cbiAgX3JlbmRlckxpa2VzKCkge1xuICAgIGlmICh0aGlzLl9saWtlQ291bnRlcikge1xuICAgICAgdGhpcy5fbGlrZUNvdW50ZXIudGV4dENvbnRlbnQgPSB0aGlzLl9saWtlcy5sZW5ndGg7XG4gICAgfVxuICB9XG5cbiAgX3VwZGF0ZUxpa2VCdXR0b24oKSB7XG4gICAgaWYgKHRoaXMuX2xpa2VCdXR0b24pIHtcbiAgICAgIGlmICh0aGlzLl9pc0xpa2VkKSB7XG4gICAgICAgIHRoaXMuX2xpa2VCdXR0b24uY2xhc3NMaXN0LmFkZChcImNhcmRfX2xpa2UtYnV0dG9uX2FjdGl2ZVwiKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRoaXMuX2xpa2VCdXR0b24uY2xhc3NMaXN0LnJlbW92ZShcImNhcmRfX2xpa2UtYnV0dG9uX2FjdGl2ZVwiKTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICBfc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XG4gICAgdGhpcy5fbGlrZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICAgICAgdGhpcy5faGFuZGxlTGlrZUNsaWNrKHRoaXMpO1xuICAgIH0pO1xuXG4gICAgdGhpcy5fZGVsZXRlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gICAgICB0aGlzLl9oYW5kbGVEZWxldGVDbGljayh0aGlzKTtcbiAgICB9KTtcblxuICAgIHRoaXMuX2NhcmRJbWFnZS5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICAgICAgdGhpcy5faGFuZGxlQ2FyZENsaWNrKHRoaXMuX25hbWUsIHRoaXMuX2xpbmspO1xuICAgIH0pO1xuICB9XG5cbiAgcmVtb3ZlQ2FyZCgpIHtcbiAgICB0aGlzLl9lbGVtZW50LnJlbW92ZSgpO1xuICAgIHRoaXMuX2VsZW1lbnQgPSBudWxsO1xuICB9XG5cbiAgZ2VuZXJhdGVDYXJkKCkge1xuICAgIHRoaXMuX2VsZW1lbnQgPSB0aGlzLl9nZXRUZW1wbGF0ZSgpO1xuICAgIHRoaXMuX2NhcmRJbWFnZSA9IHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19pbWFnZVwiKTtcbiAgICB0aGlzLl9saWtlQnV0dG9uID0gdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2xpa2UtYnV0dG9uXCIpO1xuICAgIHRoaXMuX2RlbGV0ZUJ1dHRvbiA9IHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19kZWxldGUtYnV0dG9uXCIpO1xuICAgIHRoaXMuX2xpa2VDb3VudGVyID0gdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2xpa2UtY291bnRcIik7XG5cbiAgICB0aGlzLl9zZXRFdmVudExpc3RlbmVycygpO1xuICAgIHRoaXMuX3JlbmRlckxpa2VzKCk7XG4gICAgdGhpcy5fdXBkYXRlTGlrZUJ1dHRvbigpO1xuXG4gICAgdGhpcy5fY2FyZEltYWdlLnNyYyA9IHRoaXMuX2xpbms7XG4gICAgdGhpcy5fY2FyZEltYWdlLmFsdCA9IHRoaXMuX25hbWU7XG4gICAgdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX3RpdGxlXCIpLnRleHRDb250ZW50ID0gdGhpcy5fbmFtZTtcblxuICAgIHJldHVybiB0aGlzLl9lbGVtZW50O1xuICB9XG5cbiAgX2dldFRlbXBsYXRlKCkge1xuICAgIHJldHVybiBkb2N1bWVudFxuICAgICAgLnF1ZXJ5U2VsZWN0b3IodGhpcy5fY2FyZFNlbGVjdG9yKVxuICAgICAgLmNvbnRlbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkXCIpXG4gICAgICAuY2xvbmVOb2RlKHRydWUpO1xuICB9XG59XG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBGb3JtVmFsaWRhdG9yIHtcbiAgY29uc3RydWN0b3IoY29uZmlnLCBmb3JtRWxlbWVudCkge1xuICAgIHRoaXMuX2lucHV0U2VsZWN0b3IgPSBjb25maWcuaW5wdXRTZWxlY3RvcjtcbiAgICB0aGlzLl9zdWJtaXRCdXR0b25TZWxlY3RvciA9IGNvbmZpZy5zdWJtaXRCdXR0b25TZWxlY3RvcjtcbiAgICB0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzID0gY29uZmlnLmluYWN0aXZlQnV0dG9uQ2xhc3M7XG4gICAgdGhpcy5faW5wdXRFcnJvckNsYXNzID0gY29uZmlnLmlucHV0RXJyb3JDbGFzcztcbiAgICB0aGlzLl9lcnJvckNsYXNzID0gY29uZmlnLmVycm9yQ2xhc3M7XG4gICAgdGhpcy5fZm9ybUVsZW1lbnQgPSBmb3JtRWxlbWVudDtcbiAgICB0aGlzLl9pbnB1dExpc3QgPSBBcnJheS5mcm9tKFxuICAgICAgdGhpcy5fZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvckFsbCh0aGlzLl9pbnB1dFNlbGVjdG9yKVxuICAgICk7XG4gICAgdGhpcy5fYnV0dG9uRWxlbWVudCA9IHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXG4gICAgICB0aGlzLl9zdWJtaXRCdXR0b25TZWxlY3RvclxuICAgICk7XG4gIH1cblxuICBfc2hvd0lucHV0RXJyb3IoaW5wdXRFbGVtZW50LCBlcnJvck1lc3NhZ2UpIHtcbiAgICBjb25zdCBlcnJvckVsZW1lbnQgPSB0aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKFxuICAgICAgYCMke2lucHV0RWxlbWVudC5pZH0tZXJyb3JgXG4gICAgKTtcbiAgICBpbnB1dEVsZW1lbnQuY2xhc3NMaXN0LmFkZCh0aGlzLl9pbnB1dEVycm9yQ2xhc3MpO1xuICAgIGVycm9yRWxlbWVudC50ZXh0Q29udGVudCA9IGVycm9yTWVzc2FnZTtcbiAgICBlcnJvckVsZW1lbnQuY2xhc3NMaXN0LmFkZCh0aGlzLl9lcnJvckNsYXNzKTtcbiAgfVxuXG4gIF9oaWRlSW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpIHtcbiAgICBjb25zdCBlcnJvckVsZW1lbnQgPSB0aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKFxuICAgICAgYCMke2lucHV0RWxlbWVudC5pZH0tZXJyb3JgXG4gICAgKTtcbiAgICBpbnB1dEVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9pbnB1dEVycm9yQ2xhc3MpO1xuICAgIGVycm9yRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX2Vycm9yQ2xhc3MpO1xuICAgIGVycm9yRWxlbWVudC50ZXh0Q29udGVudCA9IFwiXCI7XG4gIH1cblxuICBfY2hlY2tJbnB1dFZhbGlkaXR5KGlucHV0RWxlbWVudCkge1xuICAgIGlmICghaW5wdXRFbGVtZW50LnZhbGlkaXR5LnZhbGlkKSB7XG4gICAgICB0aGlzLl9zaG93SW5wdXRFcnJvcihpbnB1dEVsZW1lbnQsIGlucHV0RWxlbWVudC52YWxpZGF0aW9uTWVzc2FnZSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuX2hpZGVJbnB1dEVycm9yKGlucHV0RWxlbWVudCk7XG4gICAgfVxuICB9XG5cbiAgX2hhc0ludmFsaWRJbnB1dCgpIHtcbiAgICByZXR1cm4gdGhpcy5faW5wdXRMaXN0LnNvbWUoKGlucHV0RWxlbWVudCkgPT4gIWlucHV0RWxlbWVudC52YWxpZGl0eS52YWxpZCk7XG4gIH1cblxuICBfdG9nZ2xlQnV0dG9uU3RhdGUoKSB7XG4gICAgaWYgKHRoaXMuX2hhc0ludmFsaWRJbnB1dCgpKSB7XG4gICAgICB0aGlzLl9idXR0b25FbGVtZW50LmNsYXNzTGlzdC5hZGQodGhpcy5faW5hY3RpdmVCdXR0b25DbGFzcyk7XG4gICAgICB0aGlzLl9idXR0b25FbGVtZW50LmRpc2FibGVkID0gdHJ1ZTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5fYnV0dG9uRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX2luYWN0aXZlQnV0dG9uQ2xhc3MpO1xuICAgICAgdGhpcy5fYnV0dG9uRWxlbWVudC5kaXNhYmxlZCA9IGZhbHNlO1xuICAgIH1cbiAgfVxuXG4gIF9zZXRFdmVudExpc3RlbmVycygpIHtcbiAgICB0aGlzLl90b2dnbGVCdXR0b25TdGF0ZSgpO1xuICAgIHRoaXMuX2lucHV0TGlzdC5mb3JFYWNoKChpbnB1dEVsZW1lbnQpID0+IHtcbiAgICAgIGlucHV0RWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwiaW5wdXRcIiwgKCkgPT4ge1xuICAgICAgICB0aGlzLl9jaGVja0lucHV0VmFsaWRpdHkoaW5wdXRFbGVtZW50KTtcbiAgICAgICAgdGhpcy5fdG9nZ2xlQnV0dG9uU3RhdGUoKTtcbiAgICAgIH0pO1xuICAgIH0pO1xuICB9XG5cbiAgZW5hYmxlVmFsaWRhdGlvbigpIHtcbiAgICB0aGlzLl9mb3JtRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIChldnQpID0+IHtcbiAgICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgIH0pO1xuICAgIHRoaXMuX3NldEV2ZW50TGlzdGVuZXJzKCk7XG4gIH1cblxuICByZXNldFZhbGlkYXRpb24oKSB7XG4gICAgdGhpcy5fdG9nZ2xlQnV0dG9uU3RhdGUoKTtcbiAgICB0aGlzLl9pbnB1dExpc3QuZm9yRWFjaCgoaW5wdXRFbGVtZW50KSA9PiB7XG4gICAgICB0aGlzLl9oaWRlSW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpO1xuICAgIH0pO1xuICB9XG5cbiAgY2hlY2tCdXR0b25TdGF0ZSgpIHtcbiAgICB0aGlzLl90b2dnbGVCdXR0b25TdGF0ZSgpO1xuICB9XG59XG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBTZWN0aW9uIHtcbiAgY29uc3RydWN0b3IoeyBpdGVtcywgcmVuZGVyZXIgfSwgY29udGFpbmVyU2VsZWN0b3IpIHtcbiAgICB0aGlzLl9pdGVtcyA9IEFycmF5LmlzQXJyYXkoaXRlbXMpID8gaXRlbXMgOiBbXTtcbiAgICB0aGlzLl9yZW5kZXJlciA9IHJlbmRlcmVyO1xuICAgIHRoaXMuX2NvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoY29udGFpbmVyU2VsZWN0b3IpO1xuICB9XG5cbiAgcmVuZGVySXRlbXMoKSB7XG4gICAgdGhpcy5faXRlbXMuZm9yRWFjaChpdGVtID0+IHtcbiAgICAgIGlmIChpdGVtICYmIHR5cGVvZiBpdGVtID09PSAnb2JqZWN0Jykge1xuICAgICAgICB0aGlzLl9yZW5kZXJlcihpdGVtKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoXCJJbnZhbGlkIGl0ZW0gaW4gU2VjdGlvbjpcIiwgaXRlbSk7XG4gICAgICB9XG4gICAgfSk7XG4gIH1cblxuICBhZGRJdGVtKGVsZW1lbnQpIHtcbiAgICBpZiAoZWxlbWVudCkge1xuICAgICAgdGhpcy5fY29udGFpbmVyLnByZXBlbmQoZWxlbWVudCk7XG4gICAgfVxuICB9XG59XG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cCB7XG4gIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IpIHtcbiAgICB0aGlzLl9wb3B1cCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IocG9wdXBTZWxlY3Rvcik7XG4gICAgdGhpcy5faGFuZGxlRXNjQ2xvc2UgPSB0aGlzLl9oYW5kbGVFc2NDbG9zZS5iaW5kKHRoaXMpO1xuICB9XG5cbiAgb3BlbigpIHtcbiAgICB0aGlzLl9wb3B1cC5jbGFzc0xpc3QuYWRkKFwibW9kYWxfb3BlbmVkXCIpO1xuICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIHRoaXMuX2hhbmRsZUVzY0Nsb3NlKTtcbiAgfVxuXG4gIGNsb3NlKCkge1xuICAgIHRoaXMuX3BvcHVwLmNsYXNzTGlzdC5yZW1vdmUoXCJtb2RhbF9vcGVuZWRcIik7XG4gICAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgdGhpcy5faGFuZGxlRXNjQ2xvc2UpO1xuICB9XG5cbiAgX2hhbmRsZUVzY0Nsb3NlKGV2dCkge1xuICAgIGlmIChldnQua2V5ID09PSBcIkVzY2FwZVwiKSB7XG4gICAgICB0aGlzLmNsb3NlKCk7XG4gICAgfVxuICB9XG5cbiAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XG4gICAgdGhpcy5fcG9wdXAuYWRkRXZlbnRMaXN0ZW5lcihcIm1vdXNlZG93blwiLCAoZXZ0KSA9PiB7XG4gICAgICBpZiAoXG4gICAgICAgIGV2dC50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKFwibW9kYWxfb3BlbmVkXCIpIHx8XG4gICAgICAgIGV2dC50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKFwibW9kYWxfX2Nsb3NlXCIpXG4gICAgICApIHtcbiAgICAgICAgdGhpcy5jbG9zZSgpO1xuICAgICAgfVxuICAgIH0pO1xuICB9XG59XG4iLCJpbXBvcnQgUG9wdXAgZnJvbSBcIi4vUG9wdXAuanNcIjtcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXBXaXRoRm9ybSBleHRlbmRzIFBvcHVwIHtcbiAgY29uc3RydWN0b3IocG9wdXBTZWxlY3RvciwgaGFuZGxlRm9ybVN1Ym1pdCkge1xuICAgIHN1cGVyKHBvcHVwU2VsZWN0b3IpO1xuICAgIHRoaXMuX2hhbmRsZUZvcm1TdWJtaXQgPSBoYW5kbGVGb3JtU3VibWl0O1xuICAgIHRoaXMuX2Zvcm0gPSB0aGlzLl9wb3B1cC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19mb3JtXCIpO1xuICAgIHRoaXMuX2lucHV0cyA9IHRoaXMuX2Zvcm0ucXVlcnlTZWxlY3RvckFsbChcIi5tb2RhbF9faW5wdXRcIik7XG4gICAgdGhpcy5fc3VibWl0QnV0dG9uID0gdGhpcy5fZm9ybS5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19idXR0b25cIik7XG4gIH1cblxuICBfZ2V0SW5wdXRWYWx1ZXMoKSB7XG4gICAgY29uc3QgZm9ybVZhbHVlcyA9IHt9O1xuICAgIHRoaXMuX2lucHV0cy5mb3JFYWNoKChpbnB1dCkgPT4ge1xuICAgICAgZm9ybVZhbHVlc1tpbnB1dC5uYW1lXSA9IGlucHV0LnZhbHVlO1xuICAgIH0pO1xuICAgIHJldHVybiBmb3JtVmFsdWVzO1xuICB9XG5cbiAgc2V0SW5wdXRWYWx1ZXMoZGF0YSkge1xuICAgIHRoaXMuX2lucHV0cy5mb3JFYWNoKChpbnB1dCkgPT4ge1xuICAgICAgaWYgKGRhdGFbaW5wdXQubmFtZV0pIHtcbiAgICAgICAgaW5wdXQudmFsdWUgPSBkYXRhW2lucHV0Lm5hbWVdO1xuICAgICAgfVxuICAgIH0pO1xuICB9XG5cbiAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XG4gICAgc3VwZXIuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcbiAgICB0aGlzLl9mb3JtLmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgKGV2dCkgPT4ge1xuICAgICAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICBjb25zdCBpbnB1dFZhbHVlcyA9IHRoaXMuX2dldElucHV0VmFsdWVzKCk7XG4gICAgICB0aGlzLl9oYW5kbGVGb3JtU3VibWl0KGlucHV0VmFsdWVzKTtcbiAgICB9KTtcbiAgfVxuXG4gIHJlc2V0Rm9ybSgpIHtcbiAgICB0aGlzLl9mb3JtLnJlc2V0KCk7XG4gICAgaWYgKHRoaXMuX2Zvcm1WYWxpZGF0b3IpIHtcbiAgICAgIHRoaXMuX2Zvcm1WYWxpZGF0b3IucmVzZXRWYWxpZGF0aW9uKCk7XG4gICAgfVxuICB9XG5cbiAgcmVuZGVyTG9hZGluZyhpc0xvYWRpbmcsIGxvYWRpbmdUZXh0ID0gXCJTYXZpbmcuLi5cIikge1xuICAgIGlmIChpc0xvYWRpbmcpIHtcbiAgICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi50ZXh0Q29udGVudCA9IGxvYWRpbmdUZXh0O1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLl9zdWJtaXRCdXR0b24udGV4dENvbnRlbnQgPVxuICAgICAgICB0aGlzLl9zdWJtaXRCdXR0b24uZGF0YXNldC50ZXh0IHx8IFwiU2F2ZVwiO1xuICAgIH1cbiAgfVxufVxuIiwiaW1wb3J0IFwiLi9pbmRleC5jc3NcIjtcbmltcG9ydCBDYXJkIGZyb20gXCIuLi9jb21wb25lbnRzL0NhcmQuanNcIjtcbmltcG9ydCBGb3JtVmFsaWRhdG9yIGZyb20gXCIuLi9jb21wb25lbnRzL0Zvcm1WYWxpZGF0b3IuanNcIjtcbmltcG9ydCBTZWN0aW9uIGZyb20gXCIuLi9jb21wb25lbnRzL1NlY3Rpb24uanNcIjtcbmltcG9ydCBQb3B1cFdpdGhJbWFnZSBmcm9tIFwiLi4vY29tcG9uZW50cy9Qb3B1cFdpdGhJbWFnZS5qc1wiO1xuaW1wb3J0IFBvcHVwV2l0aEZvcm0gZnJvbSBcIi4uL2NvbXBvbmVudHMvUG9wdXBXaXRoRm9ybS5qc1wiO1xuaW1wb3J0IFVzZXJJbmZvIGZyb20gXCIuLi9jb21wb25lbnRzL1VzZXJJbmZvLmpzXCI7XG5pbXBvcnQgQXBpIGZyb20gXCIuLi9jb21wb25lbnRzL0FwaS5qc1wiO1xuaW1wb3J0IHsgdmFsaWRhdGlvbkNvbmZpZyB9IGZyb20gXCIuLi91dGlscy9jb25zdGFudHMuanNcIjtcbmltcG9ydCBQb3B1cFdpdGhDb25maXJtYXRpb24gZnJvbSBcIi4uL2NvbXBvbmVudHMvUG9wdXBXaXRoQ29uZmlybWF0aW9uLmpzXCI7XG5cbmZ1bmN0aW9uIGhhbmRsZVN1Ym1pdChyZXF1ZXN0LCBwb3B1cEluc3RhbmNlLCBsb2FkaW5nVGV4dCA9IFwiU2F2aW5nLi4uXCIpIHtcbiAgcG9wdXBJbnN0YW5jZS5yZW5kZXJMb2FkaW5nKHRydWUsIGxvYWRpbmdUZXh0KTtcbiAgcmV0dXJuIHJlcXVlc3QoKVxuICAgIC50aGVuKChyZXN1bHQpID0+IHtcbiAgICAgIHBvcHVwSW5zdGFuY2UuY2xvc2UoKTtcbiAgICAgIGlmIChwb3B1cEluc3RhbmNlLnJlc2V0Rm9ybSkge1xuICAgICAgICBwb3B1cEluc3RhbmNlLnJlc2V0Rm9ybSgpO1xuICAgICAgfVxuICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9KVxuICAgIC5jYXRjaCgoZXJyKSA9PiB7XG4gICAgICBjb25zb2xlLmVycm9yKGVycik7XG4gICAgfSlcbiAgICAuZmluYWxseSgoKSA9PiB7XG4gICAgICBwb3B1cEluc3RhbmNlLnJlbmRlckxvYWRpbmcoZmFsc2UpO1xuICAgIH0pO1xufVxubGV0IGNhcmRMaXN0O1xubGV0IGN1cnJlbnRVc2VySWQ7XG5cbmNvbnN0IGZvcm1WYWxpZGF0b3JzID0ge307XG5cbmNvbnN0IGRlbGV0ZUNhcmRQb3B1cCA9IG5ldyBQb3B1cFdpdGhDb25maXJtYXRpb24oXCIjZGVsZXRlLWNhcmQtbW9kYWxcIik7XG5jb25zdCBwcm9maWxlRWRpdFBvcHVwID0gbmV3IFBvcHVwV2l0aEZvcm0oXG4gIFwiI3Byb2ZpbGVfX2VkaXRfbW9kYWxcIixcbiAgaGFuZGxlUHJvZmlsZUZvcm1TdWJtaXRcbik7XG5cbi8vIHByZXR0aWVyLWlnbm9yZVxuZnVuY3Rpb24gaGFuZGxlRGVsZXRlQ2FyZChjYXJkKSB7XG4gIGRlbGV0ZUNhcmRQb3B1cC5zZXRBY3Rpb24oKCkgPT4ge1xuICAgIGZ1bmN0aW9uIG1ha2VSZXF1ZXN0KCkge1xuICAgICAgcmV0dXJuIGFwaS5kZWxldGVDYXJkKGNhcmQuZ2V0SWQoKSkudGhlbigoKSA9PiB7XG4gICAgICAgIGNhcmQucmVtb3ZlQ2FyZCgpO1xuICAgICAgfSk7XG4gICAgfVxuICAgIGhhbmRsZVN1Ym1pdChtYWtlUmVxdWVzdCwgZGVsZXRlQ2FyZFBvcHVwLCBcIkRlbGV0aW5nLi4uXCIpO1xuICB9KTtcbiAgZGVsZXRlQ2FyZFBvcHVwLm9wZW4oKTtcbn1cbmNvbnN0IGFwaSA9IG5ldyBBcGkoe1xuICBiYXNlVXJsOiBcImh0dHBzOi8vYXJvdW5kLWFwaS5lbi50cmlwbGV0ZW4tc2VydmljZXMuY29tL3YxXCIsXG4gIGhlYWRlcnM6IHtcbiAgICBhdXRob3JpemF0aW9uOiBcIjVkYjExMWFjLTAxMGEtNDU1Zi04YjY1LWE5NDg0ZDBlZmNlZVwiLFxuICAgIFwiQ29udGVudC1UeXBlXCI6IFwiYXBwbGljYXRpb24vanNvblwiLFxuICB9LFxufSk7XG5cbmNvbnN0IHVzZXJJbmZvID0gbmV3IFVzZXJJbmZvKHtcbiAgbmFtZVNlbGVjdG9yOiBcIi5wcm9maWxlX190aXRsZVwiLFxuICBqb2JTZWxlY3RvcjogXCIucHJvZmlsZV9fZGVzY3JpcHRpb25cIixcbiAgYXZhdGFyU2VsZWN0b3I6IFwiLnByb2ZpbGVfX2ltYWdlXCIsXG59KTtcblxuY29uc3QgY2FyZFRlbXBsYXRlU2VsZWN0b3IgPSBcIiNjYXJkX190ZW1wbGF0ZVwiO1xuY29uc3QgaW1hZ2VQb3B1cCA9IG5ldyBQb3B1cFdpdGhJbWFnZShcIiNpbWFnZV9tb2RhbFwiKTtcbmZ1bmN0aW9uIGhhbmRsZVByb2ZpbGVGb3JtU3VibWl0KGZvcm1EYXRhKSB7XG4gIGZ1bmN0aW9uIG1ha2VSZXF1ZXN0KCkge1xuICAgIHJldHVybiBhcGkuc2V0VXNlckluZm8oZm9ybURhdGEpLnRoZW4oKHVwZGF0ZWRVc2VyKSA9PiB7XG4gICAgICB1c2VySW5mby5zZXRVc2VySW5mbyh1cGRhdGVkVXNlcik7XG4gICAgICBwcm9maWxlRWRpdFBvcHVwLnJlc2V0Rm9ybSgpOyAvLyBSZXNldCBmb3JtIGFmdGVyIHN1Y2Nlc3NmdWwgc3VibWlzc2lvblxuICAgIH0pO1xuICB9XG4gIGhhbmRsZVN1Ym1pdChtYWtlUmVxdWVzdCwgcHJvZmlsZUVkaXRQb3B1cCk7XG59XG5cbi8vIHByZXR0aWVyLWlnbm9yZVxuY29uc3QgZWRpdFByb2ZpbGVQb3B1cCA9IG5ldyBQb3B1cFdpdGhGb3JtKFxuICBcIiNwcm9maWxlX19lZGl0X21vZGFsXCIsXG4gIChmb3JtRGF0YSkgPT4ge1xuICAgIGZ1bmN0aW9uIG1ha2VSZXF1ZXN0KCkge1xuICAgICAgcmV0dXJuIGFwaS5zZXRVc2VySW5mbyhmb3JtRGF0YSkudGhlbigodXBkYXRlZFVzZXIpID0+IHtcbiAgICAgICAgdXNlckluZm8uc2V0VXNlckluZm8odXBkYXRlZFVzZXIpO1xuICAgICAgfSk7XG4gICAgfVxuICAgIGhhbmRsZVN1Ym1pdChtYWtlUmVxdWVzdCwgZWRpdFByb2ZpbGVQb3B1cCk7XG4gIH1cbik7XG4vL3ByZXR0aWVyLWlnbm9yZVxuY29uc3QgYWRkQ2FyZFBvcHVwID0gbmV3IFBvcHVwV2l0aEZvcm0oXCIjY2FyZF9fZWRpdF9tb2RhbFwiLCAoZm9ybURhdGEpID0+IHtcbiAgZnVuY3Rpb24gbWFrZVJlcXVlc3QoKSB7XG4gICAgcmV0dXJuIGFwaS5hZGRDYXJkKHtcbiAgICAgICAgbmFtZTogZm9ybURhdGEudGl0bGUsXG4gICAgICAgIGxpbms6IGZvcm1EYXRhLnVybCxcbiAgICAgIH0pXG4gICAgICAudGhlbigoY2FyZERhdGEpID0+IHtcbiAgICAgICAgY29uc3QgY2FyZCA9IGNyZWF0ZUNhcmQoY2FyZERhdGEpO1xuICAgICAgICBjYXJkTGlzdC5hZGRJdGVtKGNhcmQpO1xuICAgICAgICByZXR1cm4gY2FyZERhdGE7XG4gICAgICB9KTtcbiAgfVxuICBoYW5kbGVTdWJtaXQobWFrZVJlcXVlc3QsIGFkZENhcmRQb3B1cCwgXCJDcmVhdGluZy4uLlwiKTtcbn0pO1xuY29uc3QgZWRpdEF2YXRhclBvcHVwID0gbmV3IFBvcHVwV2l0aEZvcm0oXCIjYXZhdGFyLWVkaXQtbW9kYWxcIiwgKGZvcm1EYXRhKSA9PiB7XG4gIGZ1bmN0aW9uIG1ha2VSZXF1ZXN0KCkge1xuICAgIHJldHVybiBhcGkudXBkYXRlQXZhdGFyKGZvcm1EYXRhLmF2YXRhcikudGhlbigodXBkYXRlZFVzZXIpID0+IHtcbiAgICAgIHVzZXJJbmZvLnNldFVzZXJJbmZvKHVwZGF0ZWRVc2VyKTtcbiAgICAgIHJldHVybiB1cGRhdGVkVXNlcjtcbiAgICB9KTtcbiAgfVxuICBoYW5kbGVTdWJtaXQobWFrZVJlcXVlc3QsIGVkaXRBdmF0YXJQb3B1cCwgXCJTYXZpbmcuLi5cIik7XG59KTtcblxuLy8gcHJldHRpZXItaWdub3JlXG5cbi8vIEluaXRpYWxpemUgYWxsIGRhdGFcblByb21pc2UuYWxsKFthcGkuZ2V0VXNlckluZm8oKSwgYXBpLmdldEluaXRpYWxDYXJkcygpXSlcbiAgLnRoZW4oKFt1c2VyRGF0YSwgaW5pdGlhbENhcmRzXSkgPT4ge1xuICAgIHVzZXJJbmZvLnNldFVzZXJJbmZvKHVzZXJEYXRhKTtcbiAgICBjdXJyZW50VXNlcklkID0gdXNlckRhdGEuX2lkO1xuICAgIGNhcmRMaXN0ID0gbmV3IFNlY3Rpb24oXG4gICAgICB7XG4gICAgICAgIGl0ZW1zOiBpbml0aWFsQ2FyZHMsXG4gICAgICAgIHJlbmRlcmVyOiAoaXRlbSkgPT4ge1xuICAgICAgICAgIGNvbnN0IGNhcmRFbGVtZW50ID0gY3JlYXRlQ2FyZChpdGVtKTtcbiAgICAgICAgICBjYXJkTGlzdC5hZGRJdGVtKGNhcmRFbGVtZW50KTtcbiAgICAgICAgfSxcbiAgICAgIH0sXG4gICAgICBcIi5jYXJkc19fbGlzdFwiXG4gICAgKTtcbiAgICBjYXJkTGlzdC5yZW5kZXJJdGVtcygpO1xuICB9KVxuICAuY2F0Y2goKGVycikgPT4gY29uc29sZS5lcnJvcihlcnIpKTtcblxuLy9wcmV0dGllci1pZ25vcmVcbmNvbnN0IHByb2ZpbGVFZGl0QnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19lZGl0LWJ1dHRvblwiKTtcbnByb2ZpbGVFZGl0QnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gIGNvbnN0IHVzZXJEYXRhID0gdXNlckluZm8uZ2V0VXNlckluZm8oKTtcbiAgcHJvZmlsZUVkaXRQb3B1cC5zZXRJbnB1dFZhbHVlcyh1c2VyRGF0YSk7XG4gIGZvcm1WYWxpZGF0b3JzW1wicHJvZmlsZS1mb3JtXCJdLnJlc2V0VmFsaWRhdGlvbigpO1xuICBwcm9maWxlRWRpdFBvcHVwLm9wZW4oKTtcbn0pO1xuXG4vL3ByZXR0aWVyLWlnbm9yZVxuY29uc3QgYWRkQ2FyZEJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fYWRkLWJ1dHRvblwiKTtcbmFkZENhcmRCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgZm9ybVZhbGlkYXRvcnNbXCJjYXJkLWZvcm1cIl0ucmVzZXRWYWxpZGF0aW9uKCk7XG4gIGFkZENhcmRQb3B1cC5vcGVuKCk7XG59KTtcblxuLy9wcmV0dGllci1pZ25vcmVcbmRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9faW1hZ2VcIikuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgaWYgKGZvcm1WYWxpZGF0b3JzW1wiYXZhdGFyLWZvcm1cIl0pIHtcbiAgICBmb3JtVmFsaWRhdG9yc1tcImF2YXRhci1mb3JtXCJdLnJlc2V0VmFsaWRhdGlvbigpO1xuICB9XG4gIGVkaXRBdmF0YXJQb3B1cC5vcGVuKCk7XG59KTtcblxuLy8gcHJldHRpZXItaWdub3JlXG5kb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2ltYWdlLWNvbnRhaW5lclwiKS5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICBmb3JtVmFsaWRhdG9yc1tcImF2YXRhci1lZGl0LWZvcm1cIl0ucmVzZXRWYWxpZGF0aW9uKCk7XG4gIGZvcm1WYWxpZGF0b3JzW1wiYXZhdGFyLWVkaXQtZm9ybVwiXS5jaGVja0J1dHRvblN0YXRlKCk7XG4gIGVkaXRBdmF0YXJQb3B1cC5vcGVuKCk7XG59KTtcbmNvbnN0IGVuYWJsZVZhbGlkYXRpb24gPSAoY29uZmlnKSA9PiB7XG4gIGNvbnN0IGZvcm1MaXN0ID0gQXJyYXkuZnJvbShkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKGNvbmZpZy5mb3JtU2VsZWN0b3IpKTtcbiAgZm9ybUxpc3QuZm9yRWFjaCgoZm9ybUVsZW1lbnQpID0+IHtcbiAgICBjb25zdCB2YWxpZGF0b3IgPSBuZXcgRm9ybVZhbGlkYXRvcihjb25maWcsIGZvcm1FbGVtZW50KTtcbiAgICBjb25zdCBmb3JtTmFtZSA9IGZvcm1FbGVtZW50LmdldEF0dHJpYnV0ZShcIm5hbWVcIik7XG4gICAgZm9ybVZhbGlkYXRvcnNbZm9ybU5hbWVdID0gdmFsaWRhdG9yO1xuICAgIHZhbGlkYXRvci5lbmFibGVWYWxpZGF0aW9uKCk7XG4gIH0pO1xufTtcblxuZW5hYmxlVmFsaWRhdGlvbih2YWxpZGF0aW9uQ29uZmlnKTtcblxuLy8gU2V0IHVwIHBvcHVwc1xuaW1hZ2VQb3B1cC5zZXRFdmVudExpc3RlbmVycygpO1xuZWRpdFByb2ZpbGVQb3B1cC5zZXRFdmVudExpc3RlbmVycygpO1xuYWRkQ2FyZFBvcHVwLnNldEV2ZW50TGlzdGVuZXJzKCk7XG5lZGl0QXZhdGFyUG9wdXAuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcbmRlbGV0ZUNhcmRQb3B1cC5zZXRFdmVudExpc3RlbmVycygpO1xuXG4vLyBwcmV0dGllci1pZ25vcmVcbmZ1bmN0aW9uIGNyZWF0ZUNhcmQoY2FyZERhdGEpIHtcbiAgY29uc3QgY2FyZCA9IG5ldyBDYXJkKHtcbiAgICBkYXRhOiB7XG4gICAgICAuLi5jYXJkRGF0YSxcbiAgICAgIG93bmVySWQ6IGNhcmREYXRhLm93bmVyID8gY2FyZERhdGEub3duZXIuX2lkIDogY2FyZERhdGEub3duZXJJZCxcbiAgICB9LFxuICAgIGhhbmRsZUNhcmRDbGljazogKG5hbWUsIGxpbmspID0+IHtcbiAgICAgIGltYWdlUG9wdXAub3BlbihuYW1lLCBsaW5rKTtcbiAgICB9LFxuICAgIGhhbmRsZURlbGV0ZUNsaWNrOiAoY2FyZCkgPT4ge1xuICAgICAgaGFuZGxlRGVsZXRlQ2FyZChjYXJkKTtcbiAgICB9LFxuICAgIGhhbmRsZUxpa2VDbGljazogKGNhcmQpID0+IHtcbiAgICAgIGNvbnN0IGlzTGlrZWQgPSBjYXJkLmlzTGlrZWQoKTtcbiAgICAgIGNvbnN0IGxpa2VQcm9taXNlID0gaXNMaWtlZCA/IGFwaS51bmxpa2VDYXJkKGNhcmQuZ2V0SWQoKSkgOiBhcGkubGlrZUNhcmQoY2FyZC5nZXRJZCgpKTtcblxuICAgICAgbGlrZVByb21pc2VcbiAgICAgICAgLnRoZW4oKHVwZGF0ZWRDYXJkKSA9PiB7XG4gICAgICAgICAgY2FyZC51cGRhdGVMaWtlcyh1cGRhdGVkQ2FyZCk7XG4gICAgICAgIH0pXG4gICAgICAgIC5jYXRjaCgoZXJyKSA9PiBjb25zb2xlLmVycm9yKFwiRXJyb3IgdXBkYXRpbmcgbGlrZTpcIiwgZXJyKSk7XG4gICAgfSxcbiAgICB1c2VySWQ6IGN1cnJlbnRVc2VySWQsXG4gIH0sIGNhcmRUZW1wbGF0ZVNlbGVjdG9yKTtcblxuICByZXR1cm4gY2FyZC5nZW5lcmF0ZUNhcmQoKTtcbn1cbiIsImltcG9ydCBQb3B1cCBmcm9tIFwiLi9Qb3B1cC5qc1wiO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cFdpdGhDb25maXJtYXRpb24gZXh0ZW5kcyBQb3B1cCB7XG4gIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IpIHtcbiAgICBzdXBlcihwb3B1cFNlbGVjdG9yKTtcbiAgICB0aGlzLl9mb3JtID0gdGhpcy5fcG9wdXAucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fZm9ybVwiKTtcbiAgICB0aGlzLl9zdWJtaXRCdXR0b24gPSB0aGlzLl9mb3JtLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2J1dHRvblwiKTtcbiAgfVxuXG4gIHNldEFjdGlvbihhY3Rpb24pIHtcbiAgICB0aGlzLl9oYW5kbGVTdWJtaXQgPSBhY3Rpb247XG4gIH1cblxuICBzZXRFdmVudExpc3RlbmVycygpIHtcbiAgICBzdXBlci5zZXRFdmVudExpc3RlbmVycygpO1xuICAgIHRoaXMuX2Zvcm0uYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCAoZXZ0KSA9PiB7XG4gICAgICBldnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgIGlmICh0eXBlb2YgdGhpcy5faGFuZGxlU3VibWl0ID09PSBcImZ1bmN0aW9uXCIpIHtcbiAgICAgICAgdGhpcy5faGFuZGxlU3VibWl0KCk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBjb25zb2xlLmVycm9yKFwiTm8gc3VibWl0IGFjdGlvbiBzZXQgZm9yIFBvcHVwV2l0aENvbmZpcm1hdGlvblwiKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfVxuICByZW5kZXJMb2FkaW5nKGlzTG9hZGluZywgbG9hZGluZ1RleHQgPSBcIkRlbGV0aW5nLi4uXCIpIHtcbiAgICBpZiAoaXNMb2FkaW5nKSB7XG4gICAgICB0aGlzLl9zdWJtaXRCdXR0b24udGV4dENvbnRlbnQgPSBsb2FkaW5nVGV4dDtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5fc3VibWl0QnV0dG9uLnRleHRDb250ZW50ID0gXCJZZXNcIjtcbiAgICB9XG4gIH1cbn1cbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIEFwaSB7XG4gIGNvbnN0cnVjdG9yKHsgYmFzZVVybCwgaGVhZGVycyB9KSB7XG4gICAgdGhpcy5fYmFzZVVybCA9IGJhc2VVcmw7XG4gICAgdGhpcy5faGVhZGVycyA9IGhlYWRlcnM7XG4gICAgY29uc29sZS5sb2coXCJBUEkgQmFzZSBVUkw6XCIsIHRoaXMuX2Jhc2VVcmwpO1xuICB9XG5cbiAgX2NoZWNrUmVzcG9uc2UocmVzKSB7XG4gICAgaWYgKHJlcy5vaykge1xuICAgICAgcmV0dXJuIHJlcy5qc29uKCk7XG4gICAgfVxuICAgIHJldHVybiBQcm9taXNlLnJlamVjdChgRXJyb3I6ICR7cmVzLnN0YXR1c31gKTtcbiAgfVxuXG4gIF9yZXF1ZXN0KGVuZHBvaW50LCBvcHRpb25zID0ge30pIHtcbiAgICBjb25zdCBmaW5hbE9wdGlvbnMgPSB7XG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxuICAgICAgLi4ub3B0aW9ucyxcbiAgICB9O1xuICAgIGNvbnN0IHVybCA9IGAke3RoaXMuX2Jhc2VVcmx9JHtlbmRwb2ludH1gO1xuICAgIHJldHVybiBmZXRjaCh1cmwsIGZpbmFsT3B0aW9ucykudGhlbih0aGlzLl9jaGVja1Jlc3BvbnNlKTtcbiAgfVxuXG4gIGdldFVzZXJJbmZvKCkge1xuICAgIHJldHVybiB0aGlzLl9yZXF1ZXN0KFwiL3VzZXJzL21lXCIpO1xuICB9XG4gIGdldEluaXRpYWxDYXJkcygpIHtcbiAgICByZXR1cm4gdGhpcy5fcmVxdWVzdChcIi9jYXJkc1wiKTtcbiAgfVxuXG4gIHNldFVzZXJJbmZvKHsgbmFtZSwgYWJvdXQgfSkge1xuICAgIGNvbnNvbGUubG9nKFwiU2VuZGluZyB1c2VyIGluZm86XCIsIHsgbmFtZSwgYWJvdXQgfSk7XG4gICAgcmV0dXJuIHRoaXMuX3JlcXVlc3QoXCIvdXNlcnMvbWVcIiwge1xuICAgICAgbWV0aG9kOiBcIlBBVENIXCIsXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7IG5hbWUsIGFib3V0IH0pLFxuICAgIH0pLnRoZW4oKGRhdGEpID0+IHtcbiAgICAgIGNvbnNvbGUubG9nKFwiUmVjZWl2ZWQgZGF0YTpcIiwgZGF0YSk7XG4gICAgICByZXR1cm4gZGF0YTtcbiAgICB9KTtcbiAgfVxuXG4gIGFkZENhcmQoeyBuYW1lLCBsaW5rIH0pIHtcbiAgICByZXR1cm4gdGhpcy5fcmVxdWVzdChcIi9jYXJkc1wiLCB7XG4gICAgICBtZXRob2Q6IFwiUE9TVFwiLFxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoeyBuYW1lLCBsaW5rIH0pLFxuICAgIH0pO1xuICB9XG5cbiAgbGlrZUNhcmQoY2FyZElkKSB7XG4gICAgcmV0dXJuIHRoaXMuX3JlcXVlc3QoYC9jYXJkcy8ke2NhcmRJZH0vbGlrZXNgLCB7XG4gICAgICBtZXRob2Q6IFwiUFVUXCIsXG4gICAgfSkudGhlbigoZGF0YSkgPT4ge1xuICAgICAgY29uc29sZS5sb2coXCJMaWtlIGNhcmQgcmVzcG9uc2U6XCIsIGRhdGEpO1xuICAgICAgcmV0dXJuIGRhdGE7XG4gICAgfSk7XG4gIH1cblxuICBkZWxldGVDYXJkKGNhcmRJZCkge1xuICAgIHJldHVybiB0aGlzLl9yZXF1ZXN0KGAvY2FyZHMvJHtjYXJkSWR9YCwge1xuICAgICAgbWV0aG9kOiBcIkRFTEVURVwiLFxuICAgIH0pO1xuICB9XG5cbiAgdW5saWtlQ2FyZChjYXJkSWQpIHtcbiAgICByZXR1cm4gdGhpcy5fcmVxdWVzdChgL2NhcmRzLyR7Y2FyZElkfS9saWtlc2AsIHtcbiAgICAgIG1ldGhvZDogXCJERUxFVEVcIixcbiAgICB9KS50aGVuKChkYXRhKSA9PiB7XG4gICAgICBjb25zb2xlLmxvZyhcIlVubGlrZSBjYXJkIHJlc3BvbnNlOlwiLCBkYXRhKTtcbiAgICAgIHJldHVybiB7IC4uLmRhdGEsIGlzTGlrZWQ6IGZhbHNlIH07XG4gICAgfSk7XG4gIH1cblxuICB1cGRhdGVBdmF0YXIoYXZhdGFyKSB7XG4gICAgcmV0dXJuIHRoaXMuX3JlcXVlc3QoXCIvdXNlcnMvbWUvYXZhdGFyXCIsIHtcbiAgICAgIG1ldGhvZDogXCJQQVRDSFwiLFxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoeyBhdmF0YXIgfSksXG4gICAgfSk7XG4gIH1cbn1cbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFVzZXJJbmZvIHtcbiAgY29uc3RydWN0b3IoeyBuYW1lU2VsZWN0b3IsIGpvYlNlbGVjdG9yLCBhdmF0YXJTZWxlY3RvciB9KSB7XG4gICAgdGhpcy5fbmFtZUVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKG5hbWVTZWxlY3Rvcik7XG4gICAgdGhpcy5fam9iRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3Ioam9iU2VsZWN0b3IpO1xuICAgIHRoaXMuX2F2YXRhckVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGF2YXRhclNlbGVjdG9yKTtcbiAgICB0aGlzLl9uYW1lID0gXCJcIjtcbiAgICB0aGlzLl9hYm91dCA9IFwiXCI7XG4gICAgdGhpcy5fYXZhdGFyID0gXCJcIjtcbiAgfVxuXG4gIGdldFVzZXJJbmZvKCkge1xuICAgIHJldHVybiB7XG4gICAgICBuYW1lOiB0aGlzLl9uYW1lLFxuICAgICAgYWJvdXQ6IHRoaXMuX2Fib3V0LFxuICAgICAgYXZhdGFyOiB0aGlzLl9hdmF0YXIsXG4gICAgfTtcbiAgfVxuXG4gIHNldFVzZXJJbmZvKHsgbmFtZSwgYWJvdXQsIGF2YXRhciB9KSB7XG4gICAgaWYgKG5hbWUpIHRoaXMuX25hbWUgPSBuYW1lO1xuICAgIGlmIChhYm91dCkgdGhpcy5fYWJvdXQgPSBhYm91dDtcbiAgICBpZiAoYXZhdGFyKSB0aGlzLl9hdmF0YXIgPSBhdmF0YXI7XG4gICAgdGhpcy51cGRhdGVET00oKTtcbiAgfVxuXG4gIHVwZGF0ZURPTSgpIHtcbiAgICB0aGlzLl9uYW1lRWxlbWVudC50ZXh0Q29udGVudCA9IHRoaXMuX25hbWU7XG4gICAgdGhpcy5fam9iRWxlbWVudC50ZXh0Q29udGVudCA9IHRoaXMuX2Fib3V0O1xuICAgIGlmICh0aGlzLl9hdmF0YXIpIHRoaXMuX2F2YXRhckVsZW1lbnQuc3JjID0gdGhpcy5fYXZhdGFyO1xuICB9XG59XG4iLCJpbXBvcnQgUG9wdXAgZnJvbSAnLi9Qb3B1cC5qcyc7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwV2l0aEltYWdlIGV4dGVuZHMgUG9wdXAge1xuICBjb25zdHJ1Y3Rvcihwb3B1cFNlbGVjdG9yKSB7XG4gICAgc3VwZXIocG9wdXBTZWxlY3Rvcik7XG4gICAgdGhpcy5faW1hZ2UgPSB0aGlzLl9wb3B1cC5xdWVyeVNlbGVjdG9yKCcubW9kYWxfX2ltYWdlJyk7XG4gICAgdGhpcy5fY2FwdGlvbiA9IHRoaXMuX3BvcHVwLnF1ZXJ5U2VsZWN0b3IoJy5tb2RhbF9fY2FwdGlvbicpO1xuICB9XG5cbiAgb3BlbihuYW1lLCBsaW5rKSB7XG4gICAgdGhpcy5faW1hZ2Uuc3JjID0gbGluaztcbiAgICB0aGlzLl9pbWFnZS5hbHQgPSBuYW1lO1xuICAgIHRoaXMuX2NhcHRpb24udGV4dENvbnRlbnQgPSBuYW1lO1xuICAgIHN1cGVyLm9wZW4oKTtcbiAgfVxufVxuIiwiZXhwb3J0IGNvbnN0IHZhbGlkYXRpb25Db25maWcgPSB7XG4gIGZvcm1TZWxlY3RvcjogXCIubW9kYWxfX2Zvcm1cIixcbiAgaW5wdXRTZWxlY3RvcjogXCIubW9kYWxfX2lucHV0XCIsXG4gIHN1Ym1pdEJ1dHRvblNlbGVjdG9yOiBcIi5tb2RhbF9fYnV0dG9uXCIsXG4gIGluYWN0aXZlQnV0dG9uQ2xhc3M6IFwibW9kYWxfX2J1dHRvbl9kaXNhYmxlZFwiLFxuICBpbnB1dEVycm9yQ2xhc3M6IFwibW9kYWxfX2lucHV0X3R5cGVfZXJyb3JcIixcbiAgZXJyb3JDbGFzczogXCJtb2RhbF9fZXJyb3JfdmlzaWJsZVwiLFxufTtcblxuZXhwb3J0IGNvbnN0IGluaXRpYWxDYXJkcyA9IFtcbiAge1xuICAgIG5hbWU6IFwiWW9zZW1pdGUgVmFsbGV5XCIsXG4gICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL2Fyb3VuZC1wcm9qZWN0L3lvc2VtaXRlLmpwZ1wiLFxuICB9LFxuICB7XG4gICAgbmFtZTogXCJMYWtlIExvdWlzZVwiLFxuICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9hcm91bmQtcHJvamVjdC9sYWtlLWxvdWlzZS5qcGdcIixcbiAgfSxcbiAge1xuICAgIG5hbWU6IFwiQmFsZCBNb3VudGFpbnNcIixcbiAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvYXJvdW5kLXByb2plY3QvYmFsZC1tb3VudGFpbnMuanBnXCIsXG4gIH0sXG4gIHtcbiAgICBuYW1lOiBcIkxhdGVtYXJcIixcbiAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvYXJvdW5kLXByb2plY3QvbGF0ZW1hci5qcGdcIixcbiAgfSxcbiAge1xuICAgIG5hbWU6IFwiVmFub2lzZSBOYXRpb25hbCBQYXJrXCIsXG4gICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL2Fyb3VuZC1wcm9qZWN0L3Zhbm9pc2UuanBnXCIsXG4gIH0sXG4gIHtcbiAgICBuYW1lOiBcIkxhZ28gZGkgQnJhaWVzXCIsXG4gICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL2Fyb3VuZC1wcm9qZWN0L2xhZ28uanBnXCIsXG4gIH0sXG5dO1xuIl0sIm5hbWVzIjpbIkNhcmQiLCJjb25zdHJ1Y3RvciIsIl9yZWYiLCJjYXJkU2VsZWN0b3IiLCJkYXRhIiwiaGFuZGxlQ2FyZENsaWNrIiwiaGFuZGxlRGVsZXRlQ2xpY2siLCJoYW5kbGVMaWtlQ2xpY2siLCJ1c2VySWQiLCJ0aGlzIiwiX25hbWUiLCJuYW1lIiwiX2xpbmsiLCJsaW5rIiwiX2lkIiwiX2xpa2VzIiwibGlrZXMiLCJfb3duZXJJZCIsIm93bmVyIiwib3duZXJJZCIsIl91c2VySWQiLCJfY2FyZFNlbGVjdG9yIiwiX2hhbmRsZUNhcmRDbGljayIsIl9oYW5kbGVEZWxldGVDbGljayIsIl9oYW5kbGVMaWtlQ2xpY2siLCJfaXNMaWtlZCIsInVuZGVmaW5lZCIsImlzTGlrZWQiLCJzb21lIiwidXNlciIsImdldElkIiwidXBkYXRlTGlrZXMiLCJ1cGRhdGVkQ2FyZCIsIl9yZW5kZXJMaWtlcyIsIl91cGRhdGVMaWtlQnV0dG9uIiwiX2xpa2VDb3VudGVyIiwidGV4dENvbnRlbnQiLCJsZW5ndGgiLCJfbGlrZUJ1dHRvbiIsImNsYXNzTGlzdCIsImFkZCIsInJlbW92ZSIsIl9zZXRFdmVudExpc3RlbmVycyIsImFkZEV2ZW50TGlzdGVuZXIiLCJfZGVsZXRlQnV0dG9uIiwiX2NhcmRJbWFnZSIsInJlbW92ZUNhcmQiLCJfZWxlbWVudCIsImdlbmVyYXRlQ2FyZCIsIl9nZXRUZW1wbGF0ZSIsInF1ZXJ5U2VsZWN0b3IiLCJzcmMiLCJhbHQiLCJkb2N1bWVudCIsImNvbnRlbnQiLCJjbG9uZU5vZGUiLCJGb3JtVmFsaWRhdG9yIiwiY29uZmlnIiwiZm9ybUVsZW1lbnQiLCJfaW5wdXRTZWxlY3RvciIsImlucHV0U2VsZWN0b3IiLCJfc3VibWl0QnV0dG9uU2VsZWN0b3IiLCJzdWJtaXRCdXR0b25TZWxlY3RvciIsIl9pbmFjdGl2ZUJ1dHRvbkNsYXNzIiwiaW5hY3RpdmVCdXR0b25DbGFzcyIsIl9pbnB1dEVycm9yQ2xhc3MiLCJpbnB1dEVycm9yQ2xhc3MiLCJfZXJyb3JDbGFzcyIsImVycm9yQ2xhc3MiLCJfZm9ybUVsZW1lbnQiLCJfaW5wdXRMaXN0IiwiQXJyYXkiLCJmcm9tIiwicXVlcnlTZWxlY3RvckFsbCIsIl9idXR0b25FbGVtZW50IiwiX3Nob3dJbnB1dEVycm9yIiwiaW5wdXRFbGVtZW50IiwiZXJyb3JNZXNzYWdlIiwiZXJyb3JFbGVtZW50IiwiaWQiLCJfaGlkZUlucHV0RXJyb3IiLCJfY2hlY2tJbnB1dFZhbGlkaXR5IiwidmFsaWRpdHkiLCJ2YWxpZCIsInZhbGlkYXRpb25NZXNzYWdlIiwiX2hhc0ludmFsaWRJbnB1dCIsIl90b2dnbGVCdXR0b25TdGF0ZSIsImRpc2FibGVkIiwiZm9yRWFjaCIsImVuYWJsZVZhbGlkYXRpb24iLCJldnQiLCJwcmV2ZW50RGVmYXVsdCIsInJlc2V0VmFsaWRhdGlvbiIsImNoZWNrQnV0dG9uU3RhdGUiLCJTZWN0aW9uIiwiY29udGFpbmVyU2VsZWN0b3IiLCJpdGVtcyIsInJlbmRlcmVyIiwiX2l0ZW1zIiwiaXNBcnJheSIsIl9yZW5kZXJlciIsIl9jb250YWluZXIiLCJyZW5kZXJJdGVtcyIsIml0ZW0iLCJjb25zb2xlIiwiZXJyb3IiLCJhZGRJdGVtIiwiZWxlbWVudCIsInByZXBlbmQiLCJQb3B1cCIsInBvcHVwU2VsZWN0b3IiLCJfcG9wdXAiLCJfaGFuZGxlRXNjQ2xvc2UiLCJiaW5kIiwib3BlbiIsImNsb3NlIiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsImtleSIsInNldEV2ZW50TGlzdGVuZXJzIiwidGFyZ2V0IiwiY29udGFpbnMiLCJQb3B1cFdpdGhGb3JtIiwiaGFuZGxlRm9ybVN1Ym1pdCIsInN1cGVyIiwiX2hhbmRsZUZvcm1TdWJtaXQiLCJfZm9ybSIsIl9pbnB1dHMiLCJfc3VibWl0QnV0dG9uIiwiX2dldElucHV0VmFsdWVzIiwiZm9ybVZhbHVlcyIsImlucHV0IiwidmFsdWUiLCJzZXRJbnB1dFZhbHVlcyIsImlucHV0VmFsdWVzIiwicmVzZXRGb3JtIiwicmVzZXQiLCJfZm9ybVZhbGlkYXRvciIsInJlbmRlckxvYWRpbmciLCJpc0xvYWRpbmciLCJsb2FkaW5nVGV4dCIsImFyZ3VtZW50cyIsImRhdGFzZXQiLCJ0ZXh0IiwiaGFuZGxlU3VibWl0IiwicmVxdWVzdCIsInBvcHVwSW5zdGFuY2UiLCJ0aGVuIiwicmVzdWx0IiwiY2F0Y2giLCJlcnIiLCJmaW5hbGx5IiwiY2FyZExpc3QiLCJjdXJyZW50VXNlcklkIiwiZm9ybVZhbGlkYXRvcnMiLCJkZWxldGVDYXJkUG9wdXAiLCJzZXRBY3Rpb24iLCJhY3Rpb24iLCJfaGFuZGxlU3VibWl0IiwicHJvZmlsZUVkaXRQb3B1cCIsImZvcm1EYXRhIiwiYXBpIiwic2V0VXNlckluZm8iLCJ1cGRhdGVkVXNlciIsInVzZXJJbmZvIiwiYmFzZVVybCIsImhlYWRlcnMiLCJfYmFzZVVybCIsIl9oZWFkZXJzIiwibG9nIiwiX2NoZWNrUmVzcG9uc2UiLCJyZXMiLCJvayIsImpzb24iLCJQcm9taXNlIiwicmVqZWN0Iiwic3RhdHVzIiwiX3JlcXVlc3QiLCJlbmRwb2ludCIsIm9wdGlvbnMiLCJmaW5hbE9wdGlvbnMiLCJ1cmwiLCJmZXRjaCIsImdldFVzZXJJbmZvIiwiZ2V0SW5pdGlhbENhcmRzIiwiX3JlZjIiLCJhYm91dCIsIm1ldGhvZCIsImJvZHkiLCJKU09OIiwic3RyaW5naWZ5IiwiYWRkQ2FyZCIsIl9yZWYzIiwibGlrZUNhcmQiLCJjYXJkSWQiLCJkZWxldGVDYXJkIiwidW5saWtlQ2FyZCIsInVwZGF0ZUF2YXRhciIsImF2YXRhciIsImF1dGhvcml6YXRpb24iLCJuYW1lU2VsZWN0b3IiLCJqb2JTZWxlY3RvciIsImF2YXRhclNlbGVjdG9yIiwiX25hbWVFbGVtZW50IiwiX2pvYkVsZW1lbnQiLCJfYXZhdGFyRWxlbWVudCIsIl9hYm91dCIsIl9hdmF0YXIiLCJ1cGRhdGVET00iLCJpbWFnZVBvcHVwIiwiX2ltYWdlIiwiX2NhcHRpb24iLCJlZGl0UHJvZmlsZVBvcHVwIiwiYWRkQ2FyZFBvcHVwIiwidGl0bGUiLCJjYXJkRGF0YSIsImNhcmQiLCJjcmVhdGVDYXJkIiwiZWRpdEF2YXRhclBvcHVwIiwiaGFuZGxlRGVsZXRlQ2FyZCIsImFsbCIsInVzZXJEYXRhIiwiaW5pdGlhbENhcmRzIiwiY2FyZEVsZW1lbnQiLCJmb3JtU2VsZWN0b3IiLCJ2YWxpZGF0b3IiLCJmb3JtTmFtZSIsImdldEF0dHJpYnV0ZSJdLCJzb3VyY2VSb290IjoiIn0=